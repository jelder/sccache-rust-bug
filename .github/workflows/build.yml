name: sccache MVP

on: push

jobs:
  build:
    env:
      SCCACHE_GHA_ENABLED: true
      RUSTC_WRAPPER: "sccache"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Configure sccache
        uses: actions/github-script@v7
        with:
          script: |
            core.exportVariable('ACTIONS_RESULTS_URL', process.env.ACTIONS_RESULTS_URL || '');
            core.exportVariable('ACTIONS_RUNTIME_TOKEN', process.env.ACTIONS_RUNTIME_TOKEN || '');
      - name: Set up sccache
        uses: mozilla-actions/sccache-action@v0.0.8
      - name: Install Rust toolchain
        uses: dtolnay/rust-toolchain@stable
      - uses: rui314/setup-mold@main
      - name: cargo clippy
        run: cargo clippy --locked -- -D warnings
      - name: cargo check
        run: cargo check --locked
